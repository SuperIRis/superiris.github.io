"use strict";const ajaxLoad=function(t,s){const i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&200===i.status&&s(i)},i.open("GET",t,!0),i.send()},AnimatedJsonSprite=function(t,s,i){for(var e in this.spriteURL=t,this.jsonURL=t.replace("png","json"),this.div=s,this.currentStep=0,s.style.backgroundImage="url("+t+")",this.containerHeight=this.div.offsetHeight,this.containerWidth=this.div.offsetWidth,this.animationStarted=!1,this.settings={loop:!1,loopStartStep:0,loopEndStep:0,frameRate:40,scale:1},i)this.settings.hasOwnProperty(e)&&(this.settings[e]=i[e]);ajaxLoad(this.jsonURL,this._onSpriteReady.bind(this))};AnimatedJsonSprite.prototype.start=function(){this.image&&this.image.complete?!this.animationStarted&&(this.animationStarted=!0,this.currentStep<this.steps||this.settings.loop)&&this._animateToEnd():this._onLoad=this.start},AnimatedJsonSprite.prototype.stop=function(t){this.meantToStop=!0,this.animationStarted=!1,this.restart=t||!1},AnimatedJsonSprite.prototype.hoverIn=function(t){this.image.complete?this.animationStarted||(this.animationStarted=!0,clearInterval(this.mainInterval),this.stepToStopForward=!isNaN(t)&&t<this.steps?t:this.steps,this._animateToEnd()):this._onLoad=this.hoverIn},AnimatedJsonSprite.prototype.hoverOut=function(t,s){this.image.complete?this.endAnimationStarted||(this.endAnimationStarted=!0,clearInterval(this.mainInterval),s=!isNaN(s)&&0<s&&s<=this.steps?s:0,this.stepToStopForward=this.steps,this.currentStep=!isNaN(t)&&0<t&&t<=this.steps?t:this.currentStep,this.currentStep<s?(this.forceReset=!0,this._animateToEnd()):this._animateToStart()):this._onLoad=this.hoverOut},AnimatedJsonSprite.prototype._onSpriteReady=function(t){var s,i;for(i in this.json=JSON.parse(t.response),this.spritesData=[],this.json.frames)s=Number(i.substr(-4)),this.spritesData[s]=this.json.frames[i];this.steps=this.spritesData.length-1,0===this.settings.loopEndStep&&this.settings.loop&&(this.settings.loopEndStep=this.steps),this.image=new Image;const e=this;this.image.onload=function(){e._onLoad()},this.image.src=this.spriteURL,this.image.complete&&this._onLoad(),this.div.style.width=this.spritesData[0].sourceSize.w*this.settings.scale+"px",this.div.style.height=this.spritesData[0].sourceSize.h*this.settings.scale+"px"},AnimatedJsonSprite.prototype._onLoad=function(){},AnimatedJsonSprite.prototype._animateToEnd=function(){var t=this._moveForward.bind(this);this.mainInterval=setInterval(t,this.settings.frameRate)},AnimatedJsonSprite.prototype._animateToStart=function(){var t=this._moveBackwards.bind(this);this.mainInterval=setInterval(t,this.settings.frameRate)},AnimatedJsonSprite.prototype.reset=function(t){this.currentStep=t=t||0,this.animationStarted=!1,this.endAnimationStarted=!1},AnimatedJsonSprite.prototype._moveBackwards=function(){var t={};t.x=this.spritesData[this.currentStep].frame.x*this.settings.scale,t.y=this.spritesData[this.currentStep].frame.y*this.settings.scale,this.div.style.backgroundPosition="-"+t.x+"px -"+t.y+"px",(this.currentStep<=0||this.currentStep>=this.stepToStopBackwards)&&(clearInterval(this.mainInterval),this.reset(0)),this.currentStep--},AnimatedJsonSprite.prototype._moveForward=function(){var t={};t.x=this.spritesData[this.currentStep].frame.x*this.settings.scale,t.y=this.spritesData[this.currentStep].frame.y*this.settings.scale,this.div.style.backgroundPosition="-"+t.x+"px -"+t.y+"px",this.meantToStop&&this.currentStep>=this.steps?(clearInterval(this.mainInterval),this.meantToStop=!1,this.currentStep=0,this.restart&&(this.restart=!1,this.reset(0))):(this.currentStep>=this.stepToStopForward||this.settings.loop&&this.currentStep>=this.settings.loopEndStep&&!this.meantToStop)&&(clearInterval(this.mainInterval),this.settings.loop?(this.reset(this.settings.loopStartStep),this.start()):this.forceReset&&(this.forceReset=!1,this.reset())),this.currentStep++};export default AnimatedJsonSprite;